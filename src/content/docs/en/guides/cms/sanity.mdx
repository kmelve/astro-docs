---
title: Sanity & Astro
description: Add content to your Astro project using Sanity as a CMS
type: cms
stub: false
service: Sanity
i18nReady: false
---


[Sanity](http://sanity.io) can be used as a headless content management system (CMS) to drive content to Astro websites. It comes with a hosted document and asset store called Content Lake, a fully customisable editing environment called Sanity Studio, and APIs that lets you integrate your content to pretty much anything.

## Quick start

The easiest way to get started, is with the official [`@sanity/astro` integration](https://github.com/sanity-io/sanity-astro). It can be added to both an existing project or a new one.

You can also try out [the clean Sanity + Astro starter template][starter] that includes a basic setup.

This quick start guide will take you from creating a new Sanity project to fetching content to make static and dynamic routes.

### Installing dependencies

Start by installing the official Sanity integration for Astro:

```shell
npx astro add @sanity/astro @astrojs/react
```

The command should add the Sanity and React configuration to your `astro.config.mjs` file. This is where you will tell Astro what your Sanity project ID is, as well as the name of your dataset (most likely `production`).

The `@astrojs/react` dependency is only needed if you plan to embedd the Studio on a route.

You are also likely to integrate [block content][portabletext] and [images from the Sanity CDN][asset-pipeline]. If that is the case, then these libraries will come in handy:


```shell
  npm install astro-portabletext @sanity/image
```

If you are using TypeScript, then you might want types coming from these libraries:

```shell
npm install @portabletext/types @sanity/types
```

### Create a Sanity project

You can always run the following command to initialize a new Studio and its dependencies with a new or existing Sanity project:

```shell
npm create sanity@latest
```

If you're using the embedded Studio, then run the following command to initalize a Sanity project, and store the `projectId` and `dataset` variables in an `.env` file. That's the only thing you need to query published content in a dataset that's not private.

```shell
npx sanity@latest init --env
```

Follow the instructions, and don't worry about messing up, with Sanity, you can make as many projects as you want. You can always go to [sanity.io/manage][manage] to find information about your projects.

### Client configuration

For simplicity, you can copy-paste the `projectId` and the `dataset` values from the `.env` and into the Astro configuration file. You don't need to treat these as secrets. [Go here for instructions][env-config] if you wish use the `.env file` for the configuration.

```javascript
// astro.config.mjs
import { defineConfig } from "astro/config";
import sanity from "@sanity/astro";

// https://astro.build/config
export default defineConfig({
  integrations: [sanity({
    projectId: '<your-project-id>',
    dataset: '<dataset-name>',
    useCdn: false, // See note on using the CDN
    apiVersion: "2023-03-20", // insert the current date to access the latest version of the API
  })]
});

```

#### CDN or not?
Sanity lets you query content through a global CDN. If you plan to keep the site static and set up webhooks that trigger rebuilds when updates are published, then you probably want `useCdn` to be `false` in order to make sure you don't hit stale content when the site builds.

If you plan to use Server Side Rendering, then you probably want to set `useCdn` to `true` for performance and cost. You can also override this setting if you run the site in hybrid, for example `useSanityClient.config({useCdn: false}).fetch(*[_type == "liveBlog"])`.

### Configuration with embedded Studio:

Sanity Studio is where you can edit and manage your content. It‘s a Single Page Application is easy to configure, and that can be customized in a lot of ways. It‘s up to you if you want to keep the Studio in a separate repository, in its own folder (as a monorepo), or embedded it into your Astro website. For the sake of simplicity, this guide will show you how to embed the Studio on its own route (remember `/wp-admin`?).


To add a Studio on `yoursite.com/admin`, you can set the configuration to the following:

```javascript
// ./astro.config.mjs
import { defineConfig } from "astro/config";
import sanity from "@sanity/astro";
import react from "@astrojs/react";

// https://astro.build/config
export default defineConfig({
  //
  output: 'hybrid',
  integrations: [sanity({
    projectId: '<your-project-id>',
    dataset: '<dataset-name>',
    useCdn: false, // See note on using the CDN
    apiVersion: "2023-03-20", // insert the current date to access the latest version of the API
    studioPath: '/admin' // If you want to access the Studio on a route
  }), react()]
});
```

Astro needs to run in `output: 'hybrid'` mode to be able to embed the Studio. Your site will still render statically by default, unless you explicitly opt out of it. This also means that you migth have to install an [adapter][adapter] depending on where you want to deploy your site.

You also need to add a configuration file for Sanity Studio in the project root:

```ts
// ./sanity.config.ts
import { defineConfig } from "sanity";
import { deskTool } from "sanity/desk";

export default defineConfig({
  name: "project-name", // Can be whatever
  title: "Project Name", // Can be whatever
  projectId: '<your-project-id>',
  dataset: '<dataset-name>',
  plugins: [deskTool()],
  schema: {
    types: [],
  },
});
```

### Fetching content from Sanity Content Lake

Once you have installed and configured the Sanity integration, you can import the client and run queries against your dataset in the [Content Lake][contentlake]. Sanity uses [GROQ][GROQ] for content queries ([you can also use GraphQL][graphql]).

The route for a simple blog index can look like this:

```astro
---
// src/pages/posts/index.astro
import { useSanityClient } from "@sanity/astro";
const posts = await useSanityClient().fetch(`*[_type == "post" && defined(slug.current)]`)
---
<h2>Blog</h2>
<section>
  <ul>
    {posts.length > 0 &&
      posts.map((post) => (
        <li><a href={`/posts/${slug.current}`}>{post?.title}</a></li>
      )))
    }
  </ul>
</section>
```

And a simple blog post route can look like this:

```astro
// src/pages/posts/[slug].astro
---
import { useSanityClient } from "@sanity/astro";
import { PortableText } from "astro-portabletext";
const { slug } = Astro.params;

export async function getStaticPaths() {
  const posts = await useSanityClient().fetch(`*[_type == "post" && defined(slug.current)]`);
  return posts.map((post) => ({
    params: { slug: post.slug.current },
  }));
}

const post = await useSanityClient().fetch(`*[_type == "post" && slug.current == slug]`, {slug})
---
<article>
  <h1>{post?.title}</h1>
  <PortableText value={post?.body} />
</article>
```
If you go beyond these simple examples, then a useful pattern is to collate content queries in [one file and export them as functions][query-file].




## Official Resources

- Guide: [Build your blog with Astro and Sanity](https://www.sanity.io/guides/sanity-astro-blog)
- [The Offical Sanity Integration for Astro][astro-sanity]
- [The Official Astro + Sanity Starter template][starter]
- [Websites built with Sanity and Astro][showcase]

## Community Resources

- [Portable Text integration for Astro][astro-portabletext]
- [Sanity picture component for Astro][astro-sanity-picture]
- The [Astro Sanity Minimal Starter](https://github.com/littlesticks/astro-sanity-minimal-starter) by Jaydan Urwin.
- Video: [Create your own Blog with Astro and Sanity.io](https://www.youtube.com/watch?v=-jAWLTfsSQw) by Jaydan Urwin

[astro–sanity]: https://github.com/sanity-io/sanity-astro
[astro-portabletext]: https://github.com/sanity-io/astro-portabletext
[astro-sanity-picture]: https://github.com/otterdev-io/astro-sanity-picture
[sanity-image]: https://github.com/sanity-io/@sanity/image
[starter]: https://www.sanity.io/templates/astro-sanity-clean
[portabletext]: https://portabletext.org
[contentlake]: https://www.sanity.io/docs/datastore
[asset-pipeline]: https://www.sanity.io/docs/asset-pipeline
[manage]: https://sanity.io/manage
[env-config]: /en/guides/configuring-astro/#environment-variables
[adapter]: /en/guides/server-side-rendering/#adding-an-adapter
[GROQ]: https://www.sanity.io/docs/groq
[graphql]: https://www.sanity.io/docs/graphql
[query-file]: https://github.com/sanity-io/sanity-template-astro-clean/blob/main/app/src/utils/sanity.ts
[showcase]: https://www.sanity.io/exchange/type=projects/framework=astro
